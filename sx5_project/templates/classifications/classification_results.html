<div class="table-responsive">
    <table id="classificationTable" class="table">
        <thead>
            <tr>
                <th scope="col" class="align-middle">Position</th>
                <th scope="col" class="align-middle">Runner</th>
                <th scope="col" class="align-middle">Category</th>
                <th scope="col" class="align-middle">General Points</th>
                <th scope="col" class="align-middle">Gender Points</th>
                <th scope="col" class="align-middle">Category Points</th>               
            </tr>
        </thead>
        <tbody>
            <div id="filterContainerClassification" class="d-flex align-items-center">
                <button id="filterMaleClassification" class="btn filter-btn filter-btn-male">Male</button>
                <button id="filterFemaleClassification" class="btn filter-btn filter-btn-female">Female</button>
                <button id="filterNonBinaryClassification" class="btn filter-btn filter-btn-nonbinary">Non-Binary</button>
                <button id="filterClearClassification" class="btn filter-btn filter-btn-clear">Clear Filter</button>
            </div>


            {% for result in classification_results %}
                {% if result.general_points != 0 or result.gender_points != 0 or result.category_points != 0 %}
                <tr class="{{ race.hover_class }}">
                    <td class="align-middle">{{ forloop.counter }}</td>
                    <td class="align-middle">{{ result.runner }}</td>
                    <td class="align-middle">{{ result.runner_category }}</td>
                    <td class="align-middle">{{ result.general_points }}</td>
                    <td class="align-middle">{{ result.gender_points }}</td>
                    <td class="align-middle">{{ result.category_points }}</td>
                </tr>
                {% endif %}
            {% endfor %}
        </tbody>
    </table>
</div>

{% block extra_js %}
<script>
    // Define the custom sort type for ascending order
    jQuery.fn.dataTableExt.oSort['category-pre-asc'] = function(a, b) {
        var categoryOrder = {
            'MS': 1, 'FS': 2, 'NBS': 3, 'M40': 4, 'F40': 5, 
            'NB40': 6, 'M50': 7, 'F50': 8, 'NB50': 9, 'M60': 10, 
            'F60': 11, 'NB60': 12, 'M70': 13, 'F70': 14, 
            'NB70': 15, 'M80': 16, 'F80': 17, 'NB80': 18
        };
        return (categoryOrder[a] < categoryOrder[b]) ? -1 : ((categoryOrder[a] > categoryOrder[b]) ? 1 : 0);
    };

    // Define the custom sort type for descending order
    jQuery.fn.dataTableExt.oSort['category-pre-desc'] = function(a, b) {
        var categoryOrder = {
            'MS': 1, 'FS': 2, 'NBS': 3, 'M40': 4, 'F40': 5, 
            'NB40': 6, 'M50': 7, 'F50': 8, 'NB50': 9, 'M60': 10, 
            'F60': 11, 'NB60': 12, 'M70': 13, 'F70': 14, 
            'NB70': 15, 'M80': 16, 'F80': 17, 'NB80': 18
        };
        return (categoryOrder[a] < categoryOrder[b]) ? 1 : ((categoryOrder[a] > categoryOrder[b]) ? -1 : 0);
    };


    var classificationTable = $('#classificationTable').DataTable({
            "paging": false,
            "info": false,
            "pageLength": -1,
            "columnDefs": [{
                "type": "category-pre",
                "targets": [2]
            }]
        });

        function filterByGenderClassification(genderPrefix) {
            classificationTable.columns(2).search('^' + genderPrefix, true, false).draw();
        }

        // Adjust IDs in event handlers
        $('#filterMaleClassification').on('click', function() {
            filterByGenderClassification('^M');
        });

        $('#filterFemaleClassification').on('click', function() {
            filterByGenderClassification('^F');
        });

        $('#filterNonBinaryClassification').on('click', function() {
            filterByGenderClassification('^N');
        });

        $('#filterClearClassification').on('click', function() {
            classificationTable.columns(2).search('').draw();
        });
    
</script>
{% endblock %}

